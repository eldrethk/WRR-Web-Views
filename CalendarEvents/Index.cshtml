
@model WRR.Models.CalendarEventViewModel

@using PagedList.Mvc;

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Calendar Events API</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

@using (Html.BeginForm("FilterBy", "CalendarEvents", FormMethod.Post))
{
    @Html.AntiForgeryToken();
    @Html.ValidationSummary(true, "", new { @class = "text-danger text-center" })
    <div class="row m-2 pb-3 justify-content-center noprint">
        <div class="form-row">     
            <div class="col-auto">
                @Html.EnumDropDownListFor(model => model.MonthEnum, "---select month---", htmlAttributes: new { @class = "custom-select" })
            </div>
            <div class="col-auto my-auto">
                <input type="submit" value="Filter" class="btn btn-primary" />
            </div>
        </div>
    </div>

}
<h2 class="text-primary text-center">@Html.DisplayFor(model => model.SelectedMonth)</h2>

@if (Model.EventQue.Count > 0)
{
    <table class="table">
        <tr>
            <th>
                Title
            </th>
            <th>
                Dates
            </th>
            <th>
                Venue
            </th>

            <th></th>
        </tr>

        @foreach (var item in Model.EventQue)
        {
            <tr>

                <td style="max-width:300px;">
                    @Html.DisplayFor(modelItem => item.Title)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.StartDate)
                    @if (item.EndDate != null)
                    {
                        <span>-</span> @Html.DisplayFor(modelItem => item.EndDate)
                    }
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Venue)
                </td>

                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.EventID }) |
                    @Html.ActionLink("Details", "Details", new { id = item.EventID })|
                    @Html.ActionLink("Delete", "Delete", new { id = item.EventID }, new { onclick = "return confirm('Are you sure you want to delete?');" })
                </td>
            </tr>
        }

    </table>
    <br />
    <div>
        @{int month = Convert.ToInt32(Request.QueryString["month"]); }        
        @Html.PagedListPager(Model.EventQue, page => Url.Action("Index", new { page, month }))

    </div>
}

else
{
    <div class="alert alert-warning">No Results</div>
}


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")


    <script type="text/javascript">


        $(function () {

            $('ul.pagination li').addClass("page-item");
            $('ul.pagination li a').addClass("page-link");


        });

    </script>

} 